environments:
  production:
    version: 2
    name: barcelona
    image_name: quay.io/degica/barcelona
    before_deploy: rake db:migrate
    slack_url: https://hooks.slack.com/services/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
    services:
      - name: web
        service_type: web
        cpu: 128
        memory: 256
        command: puma -C config/puma.rb
        force_ssl: true
        listeners:
          - endpoint: barcelona
            health_check_path: /health_check
        auto_scaling:
          min_count: 2
          max_count: 2
      - name: worker
        command: rake jobs:work
        cpu: 128
        memory: 256
        auto_scaling:
          min_count: 1
          max_count: 1
bcnd:
  mainline_branch: master
  mainline_environment: production
