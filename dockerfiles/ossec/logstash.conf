input {
	file {
		type => "ossec-alerts"
		path => "/var/ossec/logs/alerts/alerts.json"
		codec => "json"
	}
}
filter {
	geoip {
		source => "srcip"
		target => "geoip"
		database => "/etc/logstash/GeoLiteCity.dat"
		add_field => [ "[geoip][location]", "%{[geoip][longitude]}" ]
		add_field => [ "[geoip][location]", "%{[geoip][latitude]}"  ]
	}
	mutate {
		convert => [ "[geoip][location]", "float"]
		rename => [ "geoip", "GeoLocation" ]
		remove_field => [ "timestamp" ]
	}
}

output {
	elasticsearch {
		hosts => ["{{ELASTICSEARCH_URL}}"]
    ssl => true
		index => "ossec-alerts-%{+YYYY.MM.dd}"
		document_type => "wazuh"
		template => "/etc/logstash/elastic-ossec-template.json"
		template_name => "wazuh"
		template_overwrite => true
	}
}